# 1673. 考试入场

**时间限制:** 2.0 秒
**内存限制:** 64 MB

## 题目描述

上学期末，叶卡特琳堡国立大学数学与力学系的学生必须参加网络技术考试。N位教授讨论了课程设置，决定总共有N²个实验室，具体分配如下：

- 第一位教授负责的实验室编号为：1, N+1, 2N+1, ..., N²-N+1
- 第二位教授负责的实验室编号为：2, N+2, 2N+2, ..., N²-N+2
- ...
- 第N位教授负责的实验室编号为：N, 2N, 3N, ..., N²

教授们记得过去几年懒惰的学生没有参加实验室课程，因此在考试中获得了不好的成绩。所以他们决定：**只有参加了每位教授至少一个实验室的学生才能被允许参加考试**。

N名室友不知道本学期的实验室和教授人数。这些学生的勤奋程度不同：
- 第一个学生参加了所有实验室
- 第二个学生只参加了编号为2的倍数的实验室
- 第三个学生只参加了编号为3的倍数的实验室
- ...
- 第j个学生只参加了编号为j的倍数的实验室

学期末发现，恰好K个学生被允许参加考试。找出使这成为可能的最小N值。

## 输入

一个整数K (1 ≤ K ≤ 2·10⁹)

## 输出

输出满足条件的最小可能的N值。如果不存在这样的N使得恰好K个学生被允许参加考试，则输出0。

## 求解思路

### 核心分析

**关键观察：** 学生j被允许参加考试，当且仅当j是N的因子。

**证明：**
- 学生j只参加编号为j的倍数的实验室
- 要被允许参加考试，学生j必须参加每位教授的至少一个实验室
- 教授i负责的实验室编号为：i, N+i, 2N+i, ..., (N-1)·N+i
- 这些数模j余i的剩余类各不相同
- 学生j能参加教授i的实验室 ⟺ 存在某个k使得(k·N+i)≡0 (mod j)
- 这等价于：存在k使得k·N≡-i (mod j)
- 当j|N时，对任何i都存在这样的k；当j∤N时，不一定存在

因此，**恰好被允许参加考试的学生数等于N的因子个数**。

### 问题转化

设τ(N)表示N的因子个数。我们需要找最小的N使得τ(N) = K。

### 求解方法

如果 N = p₁^(a₁) × p₂^(a₂) × ... × pₖ^(aₖ)，则：

$$\tau(N) = (a_1+1)(a_2+1)...(a_k+1) = K$$

**最小化N的策略：**

1. 将K分解为因子乘积：K = d₁ × d₂ × ... × dₘ（其中每个dᵢ ≥ 2）
2. 转换为指数形式：aᵢ = dᵢ - 1
3. 按指数从大到小排序
4. 将较大的指数分配给较小的素数（2, 3, 5, 7, ...）
5. 计算N = 2^(a_max) × 3^(a_second_max) × ...

### 算法

1. 生成足够的素数（通常到100000以内）
2. 递归枚举K的所有因子分解方式
3. 对每种分解，按上述规则分配素数
4. 计算得到的N值，取最小值

### 时间复杂度

K的因子分解方式数量是有限的，通常很小。对于K≤2·10⁹，这个方法很高效。

### 特殊情况

- K=1：答案是1（N=1只有一个因子1）
- K=2：答案是2（需要τ(N)=2，最小是素数2）
- K为奇数且K>1：答案是0（除了K=1外，K必须是偶数或K=1，因为K=2时才能保证解存在）

实际上，**并非所有K都有解**。存在解的充要条件是K可以表示为至少一个形如(a+1)的因子乘积。
